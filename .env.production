# DueSync Environment Variables - PRODUCTION
# This is a template for production deployment
# Fill in actual production values before deploying

# ========================================
# DATABASE CONFIGURATION
# ========================================
DATABASE_URL="postgresql://postgres.mxsjkvtwgnosabgxwrsb:Paul2%40taskiq@aws-1-us-east-1.pooler.supabase.com:6543/postgres?pgbouncer=true&connection_limit=100"
DIRECT_URL="postgresql://postgres.mxsjkvtwgnosabgxwrsb:Paul2%40taskiq@aws-1-us-east-1.pooler.supabase.com:5432/postgres"

# ========================================
# NEXTAUTH CONFIGURATION
# ========================================
# UPDATE THIS: Replace with your production domain
NEXTAUTH_URL="https://your-production-domain.com"

# Examples:
# NEXTAUTH_URL="https://taskiq.vercel.app"
# NEXTAUTH_URL="https://duesync.wiktechnologies.com"

# GENERATE NEW: Run: openssl rand -base64 32
NEXTAUTH_SECRET="REPLACE_WITH_NEW_SECRET"

# ========================================
# GOOGLE OAUTH CONFIGURATION
# ========================================
# Get your credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID="YOUR_GOOGLE_CLIENT_ID.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="YOUR_GOOGLE_CLIENT_SECRET"

# UPDATE THIS: Must match NEXTAUTH_URL
GOOGLE_REDIRECT_URI="https://your-production-domain.com/api/auth/callback/google"

# IMPORTANT: Also update in Google Cloud Console:
# 1. Go to: https://console.cloud.google.com/apis/credentials
# 2. Select your OAuth 2.0 Client ID
# 3. Add to "Authorized redirect URIs":
#    https://your-production-domain.com/api/auth/callback/google
# 4. Add to "Authorized JavaScript origins":
#    https://your-production-domain.com

# ========================================
# SERVER CONFIGURATION
# ========================================
PORT=3000
NODE_ENV="production"

# ========================================
# PUSH NOTIFICATIONS (VAPID Keys)
# ========================================
# OPTION 1: Keep development keys (existing subscriptions continue working)
VAPID_PUBLIC_KEY="BDmZCfQuRo6coWBUzm0xBjMYQN6yNEUcHRUXK2E0Fk8fW_Ggpdo7Nkbgk66_2YeTjfUjAY29TuDvElRQ0jKhThI"
NEXT_PUBLIC_VAPID_PUBLIC_KEY="BDmZCfQuRo6coWBUzm0xBjMYQN6yNEUcHRUXK2E0Fk8fW_Ggpdo7Nkbgk66_2YeTjfUjAY29TuDvElRQ0jKhThI"
VAPID_PRIVATE_KEY="4PzB8tc7T2leGXJKHB9g04W-TTwOapXBxn1ZtgWFCtk"

# OPTION 2: Generate new keys (more secure, but invalidates existing subscriptions)
# Run: npx web-push generate-vapid-keys
# VAPID_PUBLIC_KEY="REPLACE_WITH_NEW_PUBLIC_KEY"
# NEXT_PUBLIC_VAPID_PUBLIC_KEY="REPLACE_WITH_NEW_PUBLIC_KEY"
# VAPID_PRIVATE_KEY="REPLACE_WITH_NEW_PRIVATE_KEY"

VAPID_SUBJECT="mailto:duesync@wiktechnologies.com"

# ========================================
# CRON JOB SECURITY
# ========================================
# GENERATE NEW: Run: openssl rand -base64 32
CRON_SECRET="REPLACE_WITH_NEW_SECRET"

# Add this secret to your cron service:
# - Vercel Cron: Add as environment variable
# - Upstash QStash: Add in request headers
# - Custom cron: Pass in Authorization header

# ========================================
# EMAIL CONFIGURATION (Resend)
# ========================================
# Use production API key from: https://resend.com/api-keys
RESEND_API_KEY="REPLACE_WITH_PRODUCTION_API_KEY"

# Must be verified domain in Resend
RESEND_FROM_EMAIL="noreply@your-verified-domain.com"

# Verify domain steps:
# 1. Go to: https://resend.com/domains
# 2. Add your domain
# 3. Add DNS records (SPF, DKIM, DMARC) to your DNS provider
# 4. Wait for verification (usually 24-48 hours)

# ========================================
# REDIS CONFIGURATION (Upstash)
# ========================================
# Create production database at: https://upstash.com/console/redis
UPSTASH_REDIS_REST_URL="REPLACE_WITH_PRODUCTION_REDIS_URL"
UPSTASH_REDIS_REST_TOKEN="REPLACE_WITH_PRODUCTION_REDIS_TOKEN"

# Recommended: Use separate database for production
# Free tier: 10,000 commands/day

# ========================================
# ERROR MONITORING (Sentry) - RECOMMENDED
# ========================================
# Sign up at: https://sentry.io
# Create project and get DSN
NEXT_PUBLIC_SENTRY_DSN="https://REPLACE_WITH_YOUR_SENTRY_DSN@sentry.io/PROJECT_ID"
SENTRY_AUTH_TOKEN="REPLACE_WITH_SENTRY_AUTH_TOKEN"
SENTRY_ORG="your-organization"
SENTRY_PROJECT="duesync"

# ========================================
# ANALYTICS - OPTIONAL
# ========================================
# Google Analytics
# NEXT_PUBLIC_GA_MEASUREMENT_ID="G-XXXXXXXXXX"

# Vercel Analytics auto-enabled on Vercel
# No configuration needed

# ========================================
# PRODUCTION DEPLOYMENT STEPS
# ========================================
#
# 1. PREPARE ENVIRONMENT VARIABLES:
#    □ Copy this file to your hosting platform's environment variables
#    □ Generate new NEXTAUTH_SECRET: openssl rand -base64 32
#    □ Generate new CRON_SECRET: openssl rand -base64 32
#    □ Update NEXTAUTH_URL with your production domain
#    □ Update GOOGLE_REDIRECT_URI with your production domain
#    □ Create production Redis database on Upstash
#    □ Get production Resend API key
#    □ Verify domain in Resend
#
# 2. UPDATE GOOGLE CLOUD CONSOLE:
#    □ Navigate to: https://console.cloud.google.com/apis/credentials
#    □ Select OAuth 2.0 Client ID
#    □ Add production URL to Authorized redirect URIs:
#      https://your-domain.com/api/auth/callback/google
#    □ Add production domain to Authorized JavaScript origins:
#      https://your-domain.com
#
# 3. DATABASE SETUP:
#    □ Run migrations: npx prisma migrate deploy
#    □ Verify RLS policies are enabled in Supabase
#    □ Test database connection
#
# 4. DEPLOY APPLICATION:
#    □ Deploy to Vercel/Railway/other platform
#    □ Add all environment variables to platform
#    □ Wait for deployment to complete
#    □ Check deployment logs for errors
#
# 5. CONFIGURE CRON JOBS:
#
#    For Vercel Cron (vercel.json):
#    {
#      "crons": [
#        {
#          "path": "/api/cron/generate-recurring",
#          "schedule": "0 * * * *"
#        },
#        {
#          "path": "/api/cron/send-notifications",
#          "schedule": "0 * * * *"
#        },
#        {
#          "path": "/api/cron/push-reminders",
#          "schedule": "*/15 * * * *"
#        }
#      ]
#    }
#
#    For External Cron (Upstash QStash or similar):
#    - Set up three cron jobs
#    - Add Authorization header: Bearer YOUR_CRON_SECRET
#    - URLs:
#      • https://your-domain.com/api/cron/generate-recurring (hourly)
#      • https://your-domain.com/api/cron/send-notifications (hourly)
#      • https://your-domain.com/api/cron/push-reminders (every 15 min)
#
# 6. POST-DEPLOYMENT TESTING:
#    □ Test user sign-in with Google
#    □ Create a test task
#    □ Sync task to Google Calendar
#    □ Test push notification subscription
#    □ Send test email notification
#    □ Verify cron jobs are running
#    □ Check error monitoring (Sentry)
#    □ Monitor Redis usage
#    □ Test on mobile devices
#
# 7. MONITORING & MAINTENANCE:
#    □ Set up Sentry alerts
#    □ Monitor Upstash Redis usage
#    □ Monitor Resend email quota
#    □ Check Supabase database performance
#    □ Review application logs regularly
#    □ Set up uptime monitoring (e.g., UptimeRobot)
#    □ Plan for secret rotation (every 90 days)
#
# 8. SECURITY CHECKLIST:
#    □ All secrets are unique (not from development)
#    □ HTTPS is enforced
#    □ RLS is enabled on all tables
#    □ Rate limiting is configured
#    □ CRON_SECRET is set and secure
#    □ Error monitoring is active
#    □ Sensitive data is not logged
#
# ========================================
# TROUBLESHOOTING
# ========================================
#
# Google OAuth not working:
# - Verify redirect URIs in Google Console match exactly
# - Check that Calendar API is enabled
# - Clear browser cookies and try again
#
# Cron jobs not running:
# - Verify CRON_SECRET is set correctly
# - Check cron service configuration
# - Review cron job logs
#
# Email not sending:
# - Verify domain in Resend
# - Check DNS records (SPF, DKIM, DMARC)
# - Monitor Resend dashboard for errors
# - Check email quota limits
#
# Push notifications not working:
# - Verify VAPID keys are set
# - Check browser permissions
# - Test with /api/notifications/push/test
#
# Database connection issues:
# - Verify DATABASE_URL is correct
# - Check connection_limit setting
# - Monitor Supabase dashboard
# - Review connection pooler status
#
# For more help, see:
# - README.md
# - CLAUDE.md
# - docs/GOOGLE_CALENDAR_INTEGRATION.md
# - docs/PUSH_NOTIFICATIONS.md
# - docs/EMAIL_NOTIFICATIONS.md
#
